=== XLSX Parsing Modes Demo ===

=== MODE 1: SIMPLE (default) ===
Best for: Clean tables with headers in row 1

1a. Read Excel as table (first 3 rows):
{"Month": "January", "Category": "Engineering", "Description": "Software Licenses", "Amount": 1200}
{"Month": "January", "Category": "Marketing", "Description": "Ad Campaign", "Amount": 3500}
{"Month": "January", "Category": "Operations", "Description": "Office Rent", "Amount": 4000}

1b. Filter and transform:
{"Month":"January","Amount":1200}
{"Month":"February","Amount":2200}
{"Month":"March","Amount":950}

=== MODE 2: STATS ===
Best for: Understanding unknown Excel files before parsing

2a. Get workbook overview:
{"sheet":"Summary","rows":9,"cols":4,"merged_ranges":["A1:D1"]}
{"sheet":"Monthly","rows":4,"cols":5,"merged_ranges":[]}
{"sheet":"Notes","rows":8,"cols":3,"merged_ranges":[]}

2b. See first row of each sheet (helps identify headers):
{"sheet":"Summary","first_row":["Q4 2024 Sales Report",null,null,null]}
{"sheet":"Monthly","first_row":["Month","North","South","East","West"]}
{"sheet":"Notes","first_row":["Important Notes",null,null]}

=== MODE 3: RAW ===
Best for: Complex/messy spreadsheets, LLM analysis

3a. Inspect cells with types (first 5):
{"ref":"A1","value":"Q4 2024 Sales Report","type":"s"}
{"ref":"B1","value":null,"type":"n"}
{"ref":"C1","value":null,"type":"n"}
{"ref":"D1","value":null,"type":"n"}
{"ref":"A2","value":"Generated: 2024-12-22","type":"s"}

3b. Find merged cells:
{"ref":"A1","value":"Q4 2024 Sales Report","merge":"A1:D1","merge_origin":true}
{"ref":"B1","value":null,"merge":"A1:D1","merge_origin":false}
{"ref":"C1","value":null,"merge":"A1:D1","merge_origin":false}
{"ref":"D1","value":null,"merge":"A1:D1","merge_origin":false}

3c. Find cells with comments:
{"ref":"B5","value":150000,"comment":"Exceeded expectations!"}

3d. Find hidden cells:
{"ref":"B3","value":"Review Q1 targets","hidden":true}

=== MODE 4: TABLE ===
Best for: Extracting data from specific regions with headers

4a. Extract specific range (skip title rows):
{"Region": "North", "Q4 Total": 150000, "Target": 140000, "Variance": null}
{"Region": "South", "Q4 Total": 120000, "Target": 130000, "Variance": null}
{"Region": "East", "Q4 Total": 180000, "Target": 175000, "Variance": null}
{"Region": "West", "Q4 Total": 95000, "Target": 100000, "Variance": null}

4b. Extract with column-only range:
{"Month": "October", "North": 48000, "South": 38000}
{"Month": "November", "North": 52000, "South": 42000}

=== WORKFLOW: Discover -> Extract ===

Step 1: Inspect unknown file
{"sheet":"Summary","rows":9,"merged_ranges":["A1:D1"]}

Step 2: Raw scan to find data region
{"ref":"A1","value":"Q4 2024 Sales Report"}
{"ref":"A2","value":"Generated: 2024-12-22"}
{"ref":"A4","value":"Region"}
{"ref":"A5","value":"North"}

Step 3: Extract clean table (skipping title rows)
{"Region":"North"}
{"Region":"South"}
{"Region":"East"}
{"Region":"West"}

=== Done ===
