[importlinter]
root_package = jn
include_external_packages = True

# Optional: show import chains for violations to aid refactoring
show_imports = True


# 1) High-level layering: CLI (top) -> Addressing/Core -> Foundations
# - CLI may depend on everything below.
# - Addressing/Core may depend on foundations below, but not on CLI.
# - Foundations (plugins/profiles/shell/etc.) must not depend on higher layers.
[importlinter:layers]
name = Clean architecture layers
type = layers
layers =
    jn.cli
    jn.addressing
    jn.core
    jn.plugins
    jn.profiles
    jn.shell
    jn.filtering
    jn.process_utils
    jn.introspection
    jn.context
    jn.checker


# 2) Plugins framework must not import CLI helpers or commands.
#    Plugins are a framework/service layer and should be UI-agnostic.
[importlinter:plugins_no_cli]
name = Plugins must not depend on CLI
type = forbidden
source_modules =
    jn.plugins
forbidden_modules =
    jn.cli


# 3) Core must not import CLI either (keep CLI thin and on top).
[importlinter:core_no_cli]
name = Core must not depend on CLI
type = forbidden
source_modules =
    jn.core
forbidden_modules =
    jn.cli


[importlinter:plugins_no_core]
name = Plugins must not depend on Core
type = forbidden
source_modules =
    jn.plugins
forbidden_modules =
    jn.core


# 4) CLI should not import from bundled plugin scripts package (jn_home).
#    The framework may read jn_home resources as files, but never import plugins as modules.
#    Note: import-linter only analyses static imports; dynamic resource lookups are out of scope.
[importlinter:cli_no_jn_home]
name = CLI must not import jn_home plugins
type = forbidden
source_modules =
    jn.cli
forbidden_modules =
    jn_home


# 5) Keep addressing independent from CLI (addressing is reusable service logic).
[importlinter:addressing_no_cli]
name = Addressing must not depend on CLI
type = forbidden
source_modules =
    jn.addressing
forbidden_modules =
    jn.cli


[importlinter:checker_rules_independence]
name = Checker rule modules must be independent
type = independence
modules =
    jn.checker.rules.forbidden
    jn.checker.rules.structure
    jn.checker.rules.subprocess_rules
